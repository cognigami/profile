---
---

<section class="hero" id="hero-procedural">
  <canvas id="hero-canvas"></canvas>
  
  <div class="hero-fallback" id="hero-fallback">
    <svg class="hero-waves" viewBox="0 0 100 100" preserveAspectRatio="none" aria-hidden="true">
      <defs>
        <linearGradient id="base-gradient" x1="0%" y1="0%" x2="0%" y2="100%">
          <stop offset="0%" stop-color="#1f2329"/>
          <stop offset="25%" stop-color="#3d302a"/>
          <stop offset="50%" stop-color="#c24d37"/>
          <stop offset="75%" stop-color="#d4822b"/>
          <stop offset="100%" stop-color="#f5f1e8"/>
        </linearGradient>
        
        <filter id="heavy-blur" x="-100%" y="-100%" width="300%" height="300%">
          <feGaussianBlur in="SourceGraphic" stdDeviation="8"/>
        </filter>
      </defs>
      
      <!-- Base gradient -->
      <rect width="100" height="100" fill="url(#base-gradient)"/>
      
      <!-- Wave band 1: Top golden cream (y ~38-42%) -->
      <ellipse cx="18" cy="41" rx="48" ry="7" fill="#f5bd70" fill-opacity="0.46" filter="url(#heavy-blur)"/>
      <ellipse cx="78" cy="39" rx="42" ry="8" fill="#f5bd70" fill-opacity="0.42" filter="url(#heavy-blur)"/>
      
      <!-- Wave band 2: Terracotta (y ~50-54%) -->
      <ellipse cx="22" cy="54" rx="52" ry="9" fill="#c26138" fill-opacity="0.48" filter="url(#heavy-blur)"/>
      <ellipse cx="72" cy="50" rx="46" ry="10" fill="#c26138" fill-opacity="0.45" filter="url(#heavy-blur)"/>
      
      <!-- Wave band 3: Amber (y ~62-68%) -->
      <ellipse cx="8" cy="64" rx="50" ry="10" fill="#de9452" fill-opacity="0.45" filter="url(#heavy-blur)"/>
      <ellipse cx="58" cy="69" rx="65" ry="14" fill="#de9452" fill-opacity="0.5" filter="url(#heavy-blur)"/>
      <ellipse cx="92" cy="62" rx="48" ry="9" fill="#de9452" fill-opacity="0.44" filter="url(#heavy-blur)"/>
      
      <!-- Wave band 4: Cream bleeding up (y ~83-88%) -->
      <ellipse cx="28" cy="84" rx="78" ry="24" fill="#f5f1e8" fill-opacity="0.4" filter="url(#heavy-blur)"/>
      <ellipse cx="68" cy="89" rx="70" ry="20" fill="#f5f1e8" fill-opacity="0.36" filter="url(#heavy-blur)"/>
    </svg>
  </div>
  
  <div class="hero-content">
    <div class="hero-top">
      <h1 class="hero-title">Ricardo</h1>
      <p class="hero-subtitle">Strategist, Builder, Researcher</p>
    </div>
    
    <div class="hero-bottom">
      <p class="hero-statement">
        I help organizations transform complex challenges into elegant solutions. 
        With backgrounds in <strong>engineering</strong>, <strong>education</strong>, 
        and <strong>research</strong>, I bridge the gap between ambitious ideas and 
        working systems that create lasting impact.
      </p>
    </div>
  </div>
</section>

<script>
import * as THREE from 'three';

const canvas = document.getElementById('hero-canvas') as HTMLCanvasElement | null;
const fallback = document.getElementById('hero-fallback');

if (!canvas) {
  console.log('Canvas not found');
} else if (window.innerWidth < 768) {
  canvas.style.display = 'none';
} else {
  try {
    const renderer = new THREE.WebGLRenderer({ 
      canvas, 
      alpha: true, 
      antialias: true,
      powerPreference: 'high-performance',
      failIfMajorPerformanceCaveat: false
    });
    renderer.setSize(innerWidth, innerHeight);
    renderer.setPixelRatio(Math.min(devicePixelRatio, 2));
    
    // Hide fallback when WebGL succeeds
    if (fallback) fallback.style.display = 'none';

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(45, innerWidth / innerHeight, 0.1, 10);
    camera.position.z = 1;

    const uniforms = {
      uTime: { value: 0 },
      uScroll: { value: 0 },
      uRes: { value: new THREE.Vector2(innerWidth, innerHeight) }
    };

    const material = new THREE.ShaderMaterial({
      uniforms,
      transparent: true,
      vertexShader: `
        varying vec2 vUv;
        uniform float uScroll;
        
        void main() {
          vUv = uv;
          vec3 pos = position;
          pos.y *= 1.0 - uScroll * 0.9;
          gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
        }
      `,
      fragmentShader: `
        varying vec2 vUv;
        uniform float uTime;
        uniform float uScroll;

        float wave(vec2 uv, float freq, float amp, float speed, float offset) {
          return sin(uv.x * freq + uTime * speed + offset) * amp;
        }

        void main() {
          vec2 uv = vUv;
          uv.y = 1.0 - uv.y;

          vec3 col = mix(
            vec3(0.12, 0.14, 0.16),
            vec3(0.95, 0.92, 0.88),
            uv.y
          );

          float s = 1.0 + uScroll * 1.5;

          float w1 = wave(uv, 6.0, 0.05 * s, 0.7, 0.0);
          float w2 = wave(uv, 4.5, 0.06 * s, 0.6, 2.0);
          float w3 = wave(uv, 5.5, 0.04 * s, 0.9, 4.0);

          if (uv.y < 0.65 + w1)
            col = mix(col, vec3(0.87, 0.58, 0.32), 0.8);

          if (uv.y < 0.52 + w2)
            col = mix(col, vec3(0.76, 0.38, 0.22), 0.85);

          if (uv.y < 0.40 + w3)
            col = mix(col, vec3(0.96, 0.74, 0.44), 0.9);

          gl_FragColor = vec4(col, 1.0);
        }
      `
    });

    const mesh = new THREE.Mesh(new THREE.PlaneGeometry(2, 2), material);
    scene.add(mesh);

    window.addEventListener('resize', () => {
      if (window.innerWidth < 768) {
        canvas.style.display = 'none';
        if (fallback) fallback.style.display = 'block';
        return;
      }
      canvas.style.display = 'block';
      if (fallback) fallback.style.display = 'none';
      renderer.setSize(innerWidth, innerHeight);
      camera.aspect = innerWidth / innerHeight;
      camera.updateProjectionMatrix();
      uniforms.uRes.value.set(innerWidth, innerHeight);
    });

    window.addEventListener('scroll', () => {
      uniforms.uScroll.value = Math.min(scrollY / (innerHeight * 0.5), 1);
    }, { passive: true });

    function animate(t: number) {
      uniforms.uTime.value = t * 0.001;
      renderer.render(scene, camera);
      requestAnimationFrame(animate);
    }
    animate(0);
    
  } catch (e) {
    console.error('WebGL error:', e);
    canvas.style.display = 'none';
  }
}
</script>

<style>
  .hero {
    position: relative;
    height: 100vh;
    min-height: 600px;
    overflow: hidden;
  }

  .hero canvas {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
  }

  .hero-fallback {
    position: absolute;
    inset: 0;
  }

  .hero-waves {
    width: 100%;
    height: 100%;
    display: block;
  }

  .hero-content {
    position: relative;
    z-index: 2;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    max-width: var(--content-width);
    margin: 0 auto;
    padding: 80px 24px 60px;
  }

  .hero-top {
    text-align: center;
    padding-top: 40px;
  }

  .hero-title {
    font-family: var(--font-serif);
    font-size: 52px;
    font-weight: 500;
    line-height: 1.1;
    letter-spacing: 0.01em;
    color: var(--text-primary);
    margin: 0 0 16px 0;
  }

  .hero-subtitle {
    font-family: var(--font-sans);
    font-size: 19px;
    line-height: 1.65;
    color: var(--text-secondary);
    margin: 0;
  }

  .hero-bottom {
    text-align: center;
    padding-bottom: 20px;
  }

  .hero-statement {
    font-family: var(--font-sans);
    font-size: 17px;
    line-height: 1.65;
    color: var(--bg);
    max-width: 500px;
    margin: 0 auto;
  }

  .hero-statement strong {
    font-weight: 600;
    color: var(--accent);
  }

  @media (max-width: 768px) {
    .hero {
      min-height: 70vh;
    }

    .hero-content {
      padding: 60px 24px 40px;
    }

    .hero-title {
      font-size: 36px;
    }

    .hero-subtitle {
      font-size: 17px;
    }

    .hero-statement {
      font-size: 16px;
      max-width: 100%;
    }
  }
</style>
